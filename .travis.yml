language: cpp
cache: apt
# required packages to install
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - gcc-4.8
      - g++-4.8
      - gperf
      - autoconf
      - automake
      - autotools-dev
      - libmpc-dev
      - libmpfr-dev
      - libgmp-dev
      - gawk
      - build-essential
      - bison
      - flex
      - texinfo
      - python-pexpect
      - libusb-1.0-0-dev
      - device-tree-compiler

env:
  global:
    - MAKEFLAGS="-j2"
    - PATH="/home/travis/riscv_install/bin:$PATH"

before_install:
  # don't forget to clone riscv-tests/env
  - git submodule update --init riscv-tests
  # openocd also needs submodules
  - git submodule update --init riscv-openocd

# extra time duing long builds
install: travis_wait

script:
  - ./build.sh /home/travis/riscv_install -d
  # pexpect ends up in /usr/lib/python2.7/dist-packages,
  # which is not part of the default python path.
  - PYTHONPATH=$PYTHONPATH:/usr/lib/python2.7/dist-packages make -C riscv-tests/build debug-check
